import{p as M,f as p,d as T,s as B,c as I,o as a,w as y,a as t,e as E,t as n,u as L,S as G,b as R,g as l,h as f,F as V,i as K,n as S,T as $,y as z,k as h,v as k,z as O}from"./app-m2hiUU9S.js";import{A as U}from"./AdminLayout-DTrqK3qj.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"max-w-5xl px-4 py-12 mx-auto"},q={class:"grid grid-cols-1 gap-6 mb-10 sm:grid-cols-2 lg:grid-cols-4"},H={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},J={class:"text-2xl font-bold text-gray-900 dark:text-white"},P={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},Q={class:"text-2xl font-bold text-teal-600"},X={class:"mt-1 text-xs text-gray-400"},Y={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},Z={class:"text-2xl font-bold text-indigo-600"},tt={class:"mt-1 text-xs text-gray-400"},et={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},st={class:"flex items-center justify-between mb-6"},ot={class:"overflow-x-auto bg-white shadow rounded-xl dark:bg-gray-900 ring-1 ring-black/5"},at={class:"w-full text-sm table-auto"},nt={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},lt={class:"font-medium"},rt={key:0,class:"block text-xs text-gray-400"},it={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},dt={class:"text-gray-900 dark:text-gray-100"},ct={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800 whitespace-nowrap"},ut={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},gt={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},pt=["onClick"],ft={key:1,class:"text-sm text-gray-400"},bt={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},xt={key:0,class:"text-green-700"},mt={key:1,class:"text-gray-400"},yt={class:"px-4 py-3 border-b border-gray-100 dark:border-gray-800"},ht=["href"],kt={class:"ml-1 text-xs text-gray-500"},_t={key:0},vt={key:0},wt={key:0,class:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm","aria-modal":"true",role:"dialog",tabindex:"-1"},Ct={class:"relative w-full max-w-md px-6 py-8 bg-white shadow-2xl dark:bg-gray-900 rounded-2xl animate-pop-up"},At={class:"mb-4"},Mt={class:"mb-4"},Et={class:"mb-4"},Vt={class:"flex justify-end gap-3 mt-4"},Kt={__name:"EmailCampaignIndex",props:{campaigns:{type:Array,default:()=>[]}},setup(D){const _=D,d=M(()=>Array.isArray(_.campaigns)?_.campaigns:[]),r=M(()=>{const o=d.value.length,e=d.value.filter(m=>!!m.opened_at).length,s=d.value.reduce((m,A)=>m+(A.clicked_links?Object.keys(A.clicked_links).length:0),0),g=o?Math.round(e/o*100):0,u=o?Math.round(s/o*100):0;return{total:o,opens:e,clicks:s,openRate:g,clickRate:u}}),b=p(null);let x=null;function v(){!window.Chart||!b.value||(x&&x.destroy(),x=new window.Chart(b.value.getContext("2d"),{type:"doughnut",data:{labels:["Geöffnet","Klicks","Nicht geöffnet"],datasets:[{data:[r.value.opens,r.value.clicks,r.value.total-r.value.opens],backgroundColor:["#14b8a6","#6366f1","#e5e7eb"],borderWidth:2}]},options:{cutout:"70%",plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(o){return o.label+": "+o.raw}}}}}}))}T(()=>{d.value.length&&window.Chart&&v()}),B(r,v);const c=p(!1),w=p(null),i=p({contact_name:"",contact_email:"",contact_phone:""});function C(o){if(!o)return"";const e=new Date(o);return e.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function j(o){w.value=o,i.value={contact_name:o.contact_name||"",contact_email:o.contact_email||"",contact_phone:o.contact_phone||""},c.value=!0}function N(){O.Inertia.put(`/admin/emailkonverse/${w.value.id}`,i.value,{onSuccess:()=>{c.value=!1}})}return(o,e)=>(a(),I(U,{title:"Versendete Kampagnen-E-Mails"},{default:y(()=>[t("div",W,[e[14]||(e[14]=t("h1",{class:"mb-8 text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white"}," E-Mail-Kampagnen-Übersicht ",-1)),t("div",q,[t("div",H,[e[5]||(e[5]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Kampagnen",-1)),t("span",J,n(r.value.total),1)]),t("div",P,[e[6]||(e[6]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Geöffnet",-1)),t("span",Q,n(r.value.opens),1),t("span",X,n(r.value.openRate)+"% Öffnungsrate",1)]),t("div",Y,[e[7]||(e[7]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Klicks",-1)),t("span",Z,n(r.value.clicks),1),t("span",tt,n(r.value.clickRate)+"% Klickrate",1)]),t("div",et,[e[8]||(e[8]=t("span",{class:"mb-2 text-xs font-medium text-gray-400 uppercase"},"Visualisierung",-1)),t("canvas",{ref_key:"analyticsChart",ref:b,height:"60"},null,512)])]),t("div",st,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold"},"Versendete Werbe-Mails",-1)),E(L(G),{href:"/admin/emailcampaign/create",class:"px-5 py-2 text-white bg-teal-600 rounded-lg shadow hover:bg-teal-700"},{default:y(()=>e[9]||(e[9]=[R(" + Neue Kampagne ")])),_:1,__:[9]})]),t("div",ot,[t("table",at,[e[13]||(e[13]=t("thead",{class:"text-gray-700 bg-gray-50 dark:bg-gray-800 dark:text-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-3 font-semibold text-left"}," Empfänger "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Betreff "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Gesendet "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Status "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Aktion "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Öffnung "),t("th",{class:"px-4 py-3 font-semibold text-left"}," Klicks ")])],-1)),t("tbody",null,[(a(!0),l(V,null,K(d.value,s=>(a(),l("tr",{key:s.id,class:S({"bg-green-50 dark:bg-green-900/10":s.responded,"transition-colors":!0})},[t("td",nt,[t("span",lt,n(s.recipient_email),1),s.contact_name?(a(),l("span",rt,n(s.contact_name),1)):f("",!0)]),t("td",it,[t("span",dt,n(s.subject),1)]),t("td",ct,n(C(s.sent_at)),1),t("td",ut,[t("span",{class:S(["inline-block px-3 py-1 text-xs font-semibold rounded-full",s.responded?"bg-green-100 text-green-700 dark:bg-green-700/30 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-700/30 dark:text-gray-300"])},n(s.responded?"Antwort erhalten":"Offen"),3)]),t("td",gt,[s.responded?(a(),l("span",ft,"—")):(a(),l("button",{key:0,onClick:g=>j(s),class:"px-3 py-1 text-sm font-medium text-white rounded-lg shadow bg-gradient-to-r from-teal-500 to-indigo-700 hover:from-teal-600 hover:to-indigo-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-teal-400"}," Als beantwortet markieren ",8,pt))]),t("td",bt,[s.opened_at?(a(),l("span",xt,"Geöffnet")):(a(),l("span",mt,"-"))]),t("td",yt,[t("ul",null,[(a(!0),l(V,null,K(s.clicked_links||{},(g,u)=>(a(),l("li",{key:u},[t("a",{href:u,class:"text-teal-700 underline",target:"_blank"},n(u),9,ht),t("span",kt," ("+n(C(g))+") ",1)]))),128)),!s.clicked_links||Object.keys(s.clicked_links).length===0?(a(),l("li",_t,e[11]||(e[11]=[t("span",{class:"text-gray-400"},"–",-1)]))):f("",!0)])])],2))),128)),d.value.length===0?(a(),l("tr",vt,e[12]||(e[12]=[t("td",{colspan:"7",class:"p-4 text-center text-gray-400"}," Es wurden noch keine Kampagnen versendet. ",-1)]))):f("",!0)])])])]),E($,{name:"fade"},{default:y(()=>[c.value?(a(),l("div",wt,[t("div",Ct,[t("button",{onClick:e[0]||(e[0]=s=>c.value=!1),class:"absolute text-gray-500 top-3 right-3 hover:text-teal-600 focus:outline-none","aria-label":"Dialog schließen"},e[15]||(e[15]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])),e[20]||(e[20]=t("h2",{class:"mb-6 text-2xl font-bold text-gray-800 dark:text-white"}," Antwortdaten eintragen ",-1)),t("form",{onSubmit:z(N,["prevent"])},[t("div",At,[e[16]||(e[16]=t("label",{class:"block mb-1 font-medium",for:"contact_name"},"Name Ansprechpartner",-1)),h(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.value.contact_name=s),id:"contact_name",type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off",autofocus:!0},null,512),[[k,i.value.contact_name]])]),t("div",Mt,[e[17]||(e[17]=t("label",{class:"block mb-1 font-medium",for:"contact_email"},"E-Mail Ansprechpartner",-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.value.contact_email=s),id:"contact_email",type:"email",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off"},null,512),[[k,i.value.contact_email]])]),t("div",Et,[e[18]||(e[18]=t("label",{class:"block mb-1 font-medium",for:"contact_phone"},"Telefon",-1)),h(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>i.value.contact_phone=s),id:"contact_phone",type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off"},null,512),[[k,i.value.contact_phone]])]),t("div",Vt,[t("button",{type:"button",onClick:e[4]||(e[4]=s=>c.value=!1),class:"px-4 py-2 font-medium border rounded hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none"}," Abbrechen "),e[19]||(e[19]=t("button",{type:"submit",class:"px-6 py-2 font-semibold text-white rounded-lg shadow bg-gradient-to-r from-teal-500 to-indigo-700 hover:from-teal-600 hover:to-indigo-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-teal-400"}," Speichern ",-1))])],32)])])):f("",!0)]),_:1})]),_:1}))}},Nt=F(Kt,[["__scopeId","data-v-e983aaf9"]]);export{Nt as default};
