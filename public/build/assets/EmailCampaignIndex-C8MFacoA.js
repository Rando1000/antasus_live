import{p as M,f as g,d as H,s as P,c as Q,o as n,w as m,a as t,e as b,g as a,h as p,b as k,t as o,u as N,S as V,T as _,F as B,i as I,n as z,k as w,C as X,y as Y,v as S,A as j}from"./app-CwCV0DHC.js";import{A as Z}from"./AdminLayout-DYt2XnIa.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"max-w-6xl px-4 py-10 mx-auto"},se={class:"flex flex-wrap items-center justify-between gap-3 mb-6"},le={class:"flex gap-2"},ne=["disabled"],ae={class:"grid grid-cols-1 gap-6 mb-10 sm:grid-cols-2 lg:grid-cols-4"},oe={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},ie={class:"text-2xl font-bold text-gray-900 dark:text-white"},re={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},de={class:"text-2xl font-bold text-teal-600"},ue={class:"mt-1 text-xs text-gray-400"},ce={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},ge={class:"text-2xl font-bold text-indigo-600"},pe={class:"mt-1 text-xs text-gray-400"},fe={class:"flex flex-col items-center p-6 bg-white shadow rounded-xl dark:bg-gray-900"},xe={key:0,class:"py-24 text-center opacity-80"},me={key:0,class:"overflow-x-auto bg-white shadow rounded-xl dark:bg-gray-900 ring-1 ring-black/5"},be={class:"min-w-full text-sm border-separate table-auto",style:{"border-spacing":"0"}},ve={class:"sticky top-0 z-10 text-gray-700 bg-gray-50 dark:bg-gray-800 dark:text-gray-200"},he={class:"w-8 px-2 py-3 text-center"},ye=["checked"],ke={class:"px-2 py-3 text-center"},_e=["value","aria-label"],we={class:"px-4 py-3"},Ce={class:"font-medium"},Ae={key:0,class:"block text-xs text-gray-400"},Ke={class:"px-4 py-3"},Me={class:"text-gray-900 dark:text-gray-100"},Se={class:"px-4 py-3 whitespace-nowrap"},je={class:"px-4 py-3"},De={class:"px-4 py-3"},Ee=["onClick"],Te={key:1,class:"text-sm text-gray-400"},$e={class:"px-4 py-3"},Le={key:0,class:"text-green-700"},Ne={key:1,class:"text-gray-400"},Ve={class:"px-4 py-3"},Be=["href"],Ie={class:"ml-1 text-xs text-gray-500"},ze={key:0},Ge={class:"px-2 py-3 text-center"},Re=["onClick","title"],Ue={key:0,class:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm","aria-modal":"true",role:"dialog",tabindex:"-1"},Oe={class:"relative w-full max-w-md px-6 py-8 bg-white shadow-2xl dark:bg-gray-900 rounded-2xl animate-pop-up"},Fe={class:"mb-4"},Je={class:"mb-4"},We={class:"mb-4"},qe={class:"flex justify-end gap-3 mt-4"},He={key:0,class:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60 backdrop-blur-sm","aria-modal":"true",role:"dialog"},Pe={class:"w-full max-w-sm p-8 text-center bg-white shadow-2xl dark:bg-gray-900 rounded-xl"},Qe={class:"mb-4 text-gray-700 dark:text-gray-200"},Xe={class:"flex justify-center gap-3 mt-4"},Ye=["disabled"],Ze={key:0,class:"fixed bottom-6 right-8 z-[500] bg-teal-700 text-white px-5 py-3 rounded-lg shadow-lg font-semibold text-sm"},et={__name:"EmailCampaignIndex",props:{campaigns:{type:Array,default:()=>[]}},setup(G){const D=G,r=M(()=>Array.isArray(D.campaigns)?D.campaigns:[]),i=g([]),f=g(!1),u=g(""),v=g(!1),R=M(()=>r.value.length>0&&i.value.length===r.value.length);function U(l){l.target.checked?i.value=r.value.map(e=>e.id):i.value=[]}const d=M(()=>{const l=r.value.length,e=r.value.filter(K=>!!K.opened_at).length,s=r.value.reduce((K,L)=>K+(L.clicked_links?Object.keys(L.clicked_links).length:0),0),x=l?Math.round(e/l*100):0,y=l?Math.round(s/l*100):0;return{total:l,opens:e,clicks:s,openRate:x,clickRate:y}}),C=g(null);let A=null;function E(){!window.Chart||!C.value||(A&&A.destroy(),A=new window.Chart(C.value.getContext("2d"),{type:"doughnut",data:{labels:["Geöffnet","Klicks","Nicht geöffnet"],datasets:[{data:[d.value.opens,d.value.clicks,d.value.total-d.value.opens],backgroundColor:["#14b8a6","#6366f1","#e5e7eb"],borderWidth:2}]},options:{cutout:"70%",plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(l){return l.label+": "+l.raw}}}}}}))}H(()=>{r.value.length&&window.Chart&&E()}),P(d,E);const h=g(!1),T=g(null),c=g({contact_name:"",contact_email:"",contact_phone:""});function $(l){if(!l)return"";const e=new Date(l);return e.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function O(l){T.value=l,c.value={contact_name:l.contact_name||"",contact_email:l.contact_email||"",contact_phone:l.contact_phone||""},h.value=!0}function F(){j.Inertia.put(`/admin/emailkonverse/${T.value.id}`,c.value,{onSuccess:()=>{h.value=!1,u.value="Antwortdaten gespeichert!",setTimeout(()=>u.value="",2600)}})}function J(l){confirm("Diese Kampagne wirklich löschen?")&&(f.value=!0,j.Inertia.delete(`/admin/emailcampaign/${l}`,{onSuccess:()=>{f.value=!1,u.value="Kampagne gelöscht!",setTimeout(()=>u.value="",2600),i.value=i.value.filter(e=>e!==l)}}))}function W(){v.value=!0}function q(){i.value.length&&(f.value=!0,j.Inertia.post("/admin/emailcampaign/bulk-delete",{ids:i.value},{onSuccess:()=>{f.value=!1,v.value=!1,u.value=`${i.value.length} Kampagnen gelöscht!`,setTimeout(()=>u.value="",2600),i.value=[]},onError:()=>{f.value=!1,v.value=!1}}))}return(l,e)=>(n(),Q(Z,{title:"E-Mail-Kampagnen"},{default:m(()=>[t("div",te,[t("div",se,[e[9]||(e[9]=t("h1",{class:"text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white"}," E-Mail-Kampagnen-Übersicht ",-1)),t("div",le,[i.value.length?(n(),a("button",{key:0,onClick:W,class:"flex items-center gap-1 px-4 py-2 text-sm font-semibold text-white bg-red-600 rounded shadow hover:bg-red-700 focus-visible:outline focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-400",disabled:f.value,"aria-label":"Ausgewählte Kampagnen löschen"},[e[7]||(e[7]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),k(" Löschen ("+o(i.value.length)+") ",1)],8,ne)):p("",!0),b(N(V),{href:"/admin/emailcampaign/create",class:"px-5 py-2 text-white bg-teal-600 rounded-lg shadow hover:bg-teal-700","aria-label":"Neue Kampagne anlegen"},{default:m(()=>e[8]||(e[8]=[k("+ Neue Kampagne")])),_:1,__:[8]})])]),t("div",ae,[t("div",oe,[e[10]||(e[10]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Kampagnen",-1)),t("span",ie,o(d.value.total),1)]),t("div",re,[e[11]||(e[11]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Geöffnet",-1)),t("span",de,o(d.value.opens),1),t("span",ue,o(d.value.openRate)+"% Öffnungsrate",1)]),t("div",ce,[e[12]||(e[12]=t("span",{class:"mb-1 text-xs font-medium text-gray-400 uppercase"},"Klicks",-1)),t("span",ge,o(d.value.clicks),1),t("span",pe,o(d.value.clickRate)+"% Klickrate",1)]),t("div",fe,[e[13]||(e[13]=t("span",{class:"mb-2 text-xs font-medium text-gray-400 uppercase"},"Visualisierung",-1)),t("canvas",{ref_key:"analyticsChart",ref:C,height:"60"},null,512)])]),b(_,{name:"fade"},{default:m(()=>[r.value.length===0?(n(),a("div",xe,[e[15]||(e[15]=t("img",{src:"/images/empty-state.svg",alt:"",class:"w-32 mx-auto mb-4"},null,-1)),e[16]||(e[16]=t("div",{class:"mb-2 text-lg font-semibold text-gray-500"}," Noch keine Kampagnen versendet. ",-1)),b(N(V),{href:"/admin/emailcampaign/create",class:"inline-block px-6 py-2 mt-3 text-white bg-teal-600 rounded-lg shadow hover:bg-teal-700"},{default:m(()=>e[14]||(e[14]=[k("Jetzt anlegen")])),_:1,__:[14]})])):p("",!0)]),_:1}),r.value.length?(n(),a("div",me,[t("table",be,[t("thead",ve,[t("tr",null,[t("th",he,[t("input",{type:"checkbox",checked:R.value,onChange:U,"aria-label":"Alle auswählen"},null,40,ye)]),e[17]||(e[17]=t("th",{class:"px-4 py-3 text-left"},"Empfänger",-1)),e[18]||(e[18]=t("th",{class:"px-4 py-3 text-left"},"Betreff",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-3 text-left"},"Gesendet",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-3 text-left"},"Status",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-3 text-left"},"Aktion",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-3 text-left"},"Öffnung",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-3 text-left"},"Klicks",-1)),e[24]||(e[24]=t("th",{class:"w-8 px-2 py-3 text-center"},null,-1))])]),t("tbody",null,[(n(!0),a(B,null,I(r.value,s=>(n(),a("tr",{key:s.id,tabindex:0,class:z({"bg-green-50 dark:bg-green-900/10":s.responded,"focus:outline-none focus:ring-2 focus:ring-teal-400":!0})},[t("td",ke,[w(t("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":e[0]||(e[0]=x=>i.value=x),"aria-label":`Kampagne ${s.id} auswählen`},null,8,_e),[[X,i.value]])]),t("td",we,[t("span",Ce,o(s.recipient_email),1),s.contact_name?(n(),a("span",Ae,o(s.contact_name),1)):p("",!0)]),t("td",Ke,[t("span",Me,o(s.subject),1)]),t("td",Se,o($(s.sent_at)),1),t("td",je,[t("span",{class:z(["inline-block px-3 py-1 text-xs font-semibold rounded-full",s.responded?"bg-green-100 text-green-700 dark:bg-green-700/30 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-700/30 dark:text-gray-300"])},o(s.responded?"Antwort erhalten":"Offen"),3)]),t("td",De,[s.responded?(n(),a("span",Te,"—")):(n(),a("button",{key:0,onClick:x=>O(s),class:"px-3 py-1 text-sm font-medium text-white rounded-lg shadow bg-gradient-to-r from-teal-500 to-indigo-700 hover:from-teal-600 hover:to-indigo-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-teal-400","aria-label":"Als beantwortet markieren"}," Als beantwortet ",8,Ee))]),t("td",$e,[s.opened_at?(n(),a("span",Le,"Geöffnet")):(n(),a("span",Ne,"-"))]),t("td",Ve,[t("ul",null,[(n(!0),a(B,null,I(s.clicked_links||{},(x,y)=>(n(),a("li",{key:y},[t("a",{href:y,class:"text-teal-700 underline break-all",target:"_blank",rel:"noopener",tabindex:"0"},o(y),9,Be),t("span",Ie,"("+o($(x))+")",1)]))),128)),!s.clicked_links||Object.keys(s.clicked_links).length===0?(n(),a("li",ze,e[25]||(e[25]=[t("span",{class:"text-gray-400"},"–",-1)]))):p("",!0)])]),t("td",Ge,[t("button",{onClick:x=>J(s.id),class:"text-red-500 hover:text-red-700 focus:outline-none","aria-label":"Kampagne löschen",title:`Kampagne löschen (${s.subject})`},e[26]||(e[26]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Re)])],2))),128))])])])):p("",!0)]),b(_,{name:"fade"},{default:m(()=>[h.value?(n(),a("div",Ue,[t("div",Oe,[t("button",{onClick:e[1]||(e[1]=s=>h.value=!1),class:"absolute text-gray-500 top-3 right-3 hover:text-teal-600 focus:outline-none","aria-label":"Dialog schließen"},e[27]||(e[27]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])),e[32]||(e[32]=t("h2",{class:"mb-6 text-2xl font-bold text-gray-800 dark:text-white"}," Antwortdaten eintragen ",-1)),t("form",{onSubmit:Y(F,["prevent"])},[t("div",Fe,[e[28]||(e[28]=t("label",{class:"block mb-1 font-medium",for:"contact_name"},"Name Ansprechpartner",-1)),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.value.contact_name=s),id:"contact_name",type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off",autofocus:!0},null,512),[[S,c.value.contact_name]])]),t("div",Je,[e[29]||(e[29]=t("label",{class:"block mb-1 font-medium",for:"contact_email"},"E-Mail Ansprechpartner",-1)),w(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>c.value.contact_email=s),id:"contact_email",type:"email",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off"},null,512),[[S,c.value.contact_email]])]),t("div",We,[e[30]||(e[30]=t("label",{class:"block mb-1 font-medium",for:"contact_phone"},"Telefon",-1)),w(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>c.value.contact_phone=s),id:"contact_phone",type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-teal-400 focus:outline-none",autocomplete:"off"},null,512),[[S,c.value.contact_phone]])]),t("div",qe,[t("button",{type:"button",onClick:e[5]||(e[5]=s=>h.value=!1),class:"px-4 py-2 font-medium border rounded hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none"}," Abbrechen "),e[31]||(e[31]=t("button",{type:"submit",class:"px-6 py-2 font-semibold text-white rounded-lg shadow bg-gradient-to-r from-teal-500 to-indigo-700 hover:from-teal-600 hover:to-indigo-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-teal-400"}," Speichern ",-1))])],32)])])):p("",!0)]),_:1}),b(_,{name:"fade"},{default:m(()=>[v.value?(n(),a("div",He,[t("div",Pe,[e[35]||(e[35]=t("h3",{class:"mb-4 text-xl font-bold text-gray-900 dark:text-white"}," Kampagnen löschen ",-1)),t("div",Qe,[e[33]||(e[33]=k(" Möchtest du ")),t("b",null,o(i.value.length),1),e[34]||(e[34]=k(" Kampagnen unwiderruflich löschen? "))]),t("div",Xe,[t("button",{onClick:e[6]||(e[6]=s=>v.value=!1),class:"px-4 py-2 border rounded focus:outline-none"}," Abbrechen "),t("button",{onClick:q,class:"px-6 py-2 font-semibold text-white bg-red-600 rounded hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-red-400",disabled:f.value}," Löschen ",8,Ye)])])])):p("",!0)]),_:1}),b(_,{name:"fade"},{default:m(()=>[u.value?(n(),a("div",Ze,o(u.value),1)):p("",!0)]),_:1})]),_:1}))}},nt=ee(et,[["__scopeId","data-v-4ac1093f"]]);export{nt as default};
